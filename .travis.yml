language: c

compiler:
  - clang
  - gcc

os:
  - linux
#  - osx

before_install:
 - sudo apt-get update -qq
 - sudo apt-get install -qq libcunit1 libcunit1-doc libcunit1-dev valgrind
 - sudo apt-get install -qq python-pip python-yaml
 - sudo pip install cpp-coveralls PyYAML

env:
  matrix:
  - CONFIG=Cov
#  - CONFIG=Release # turn release off -> travis using Ubuntu 12.04, valgrind 3.7


script: make CONF=$CONFIG && make CONF=$CONFIG test && ./valgrind-tests.sh

after_success:
  - if [ "$CONFIG" = "Cov" ] && [ "$CC" = "gcc" ]; then coveralls --exclude tests --exclude lib -b. --gcov-options '\-lp' ; fi

notifications:
  email: false